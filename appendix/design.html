<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Design - Pikelet Language Book</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="Documentation for the Pikelet Language">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    </head>
    <body class="light">
        <!-- Provide site root to javascript -->
        <script type="text/javascript">var path_to_root = "../";</script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { } 
            if (theme === null || theme === undefined) { theme = 'light'; }
            document.body.className = theme;
            document.querySelector('html').className = theme + ' js';
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <ol class="chapter"><li class="affix"><a href="../index.html">Pikelet</a></li><li><a href="../installation/index.html"><strong aria-hidden="true">1.</strong> Installation</a></li><li><a href="../language/index.html"><strong aria-hidden="true">2.</strong> Language</a></li><li><ol class="section"><li><a href="../language/conditionals.html"><strong aria-hidden="true">2.1.</strong> Conditionals</a></li><li><a href="../language/records.html"><strong aria-hidden="true">2.2.</strong> Records</a></li><li><a href="../language/functions.html"><strong aria-hidden="true">2.3.</strong> Functions</a></li><li><a href="../language/modules.html"><strong aria-hidden="true">2.4.</strong> Modules</a></li><li><a href="../language/type-inference.html"><strong aria-hidden="true">2.5.</strong> Type inference</a></li><li><a href="../language/types-of-types.html"><strong aria-hidden="true">2.6.</strong> Types of types</a></li></ol></li><li><a href="../appendix/index.html"><strong aria-hidden="true">3.</strong> Appendix</a></li><li><ol class="section"><li><a href="../appendix/design.html" class="active"><strong aria-hidden="true">3.1.</strong> Design</a></li><li><a href="../appendix/theory.html"><strong aria-hidden="true">3.2.</strong> Theory</a></li><li><a href="../appendix/implementation.html"><strong aria-hidden="true">3.3.</strong> Implementation</a></li><li><a href="../appendix/influences.html"><strong aria-hidden="true">3.4.</strong> Influences</a></li><li><a href="../appendix/references.html"><strong aria-hidden="true">3.5.</strong> References</a></li></ol></li></ol>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem" class="theme" id="light">Light <span class="default">(default)</span></button></li>
                                <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            </ul>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                        </div>

                        <h1 class="menu-title">Pikelet Language Book</h1> 

                        <div class="right-buttons">
                            <a href="../print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                        </div>
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <a class="header" href="#design" id="design"><h1>Design</h1></a>
<a class="header" href="#design-goals" id="design-goals"><h2>Design goals</h2></a>
<p>Pikelet should feel:</p>
<ul>
<li>Friendly</li>
<li>Liberating</li>
<li>Sympathetic</li>
</ul>
<p>This is a rough list of things that might be interesting to explore with Pikelet:</p>
<ul>
<li>Sympathetic to humans
<ul>
<li>Programs should look pretty, and read clearly</li>
<li>Friendly community</li>
<li>Helpful interactive tooling</li>
<li>Tight feedback loops</li>
</ul>
</li>
<li>Sympathetic to machines
<ul>
<li>Predictable performance</li>
<li>Predictable memory layout</li>
<li>Predictable optimizations</li>
<li>Zero (or close to zero) cost abstractions</li>
<li>Low level control</li>
<li>Minimal runtime</li>
</ul>
</li>
<li>Sympathetic to real-world realities
<ul>
<li>Gradual correctness (eg. examples -&gt; generative tests -&gt; solvers -&gt; proofs)</li>
<li>Provide clearly marked escape hatches (learn from the lessons of <a href="rust-belt">RustBelt</a>?)</li>
<li>Automatic upgrades of code - between language and library versions</li>
<li>Work for large scale systems</li>
</ul>
</li>
<li>Sympathetic to mathematical foundations
<ul>
<li>Simple core language that can be formalized and proven sound</li>
<li>Should allow for mathematically inspired patterns of code reuse</li>
<li>Allow newcomers to learn mathematical thinking gradually</li>
<li>Adaptable to future developments in type theory</li>
</ul>
</li>
</ul>
<p>It's unclear how many of these will be able to be met, and what priorities these
should have, so this list might change over time. Come and <a href="https://gitter.im/pikelet-lang/Lobby">chat with us</a>
if you'd like to give your input and get involved!</p>
<a class="header" href="#some-key-features-of-interest" id="some-key-features-of-interest"><h2>Some key features of interest</h2></a>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Dependent_type">Dependent types</a></li>
<li><a href="https://en.wikipedia.org/wiki/Pure_function">Purely functional</a></li>
<li><a href="https://en.wikipedia.org/wiki/Eager_evaluation">Strict evaluation</a></li>
<li>Implicit arguments</li>
<li>Dependent records+instance arguments as first class modules/type classes</li>
<li>Non-uniform memory layout</li>
<li><a href="https://bentnib.org/quantitative-type-theory.pdf">Quantitative type theory</a>
for <a href="https://en.wikipedia.org/wiki/Type_erasure">erasure</a> and
<a href="https://en.wikipedia.org/wiki/Substructural_type_system#Linear_type_systems">linear types</a></li>
<li>Totality checking</li>
<li>Explicit tail-call elimination</li>
<li>Interactive program development using holes</li>
</ul>
<p>Some more hand-wavey ideas:</p>
<ul>
<li>Monomorphization by partial-evaluation of instance arguments</li>
<li>Optional/configurable garbage collection</li>
<li>Alternatives to currying for function application?</li>
<li>First-class declarations (Levitation or Elaborator Reflection could be useful here)</li>
</ul>
<p>Some other features that may be trickier to integrate given the previous
features and design goals:</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Effect_system">Effect systems/Algebraic Effects</a>
<ul>
<li>could make it easier to integrate async-io without needing to build it in</li>
<li>how do cubical type theory and observational type theory play into this?</li>
<li>how do we makes this <em>fast</em> for systems programming?
<ul>
<li>should compile down in a similar way to the equivalent procedural code in Rust or C</li>
<li>most systems cause lots of intermediate allocations or stack switching</li>
</ul>
</li>
</ul>
</li>
<li><a href="https://www.cs.kent.ac.uk/people/staff/dao7/publ/combining-effects-and-coeffects-icfp16.pdf">Combined Effects/Coeffects</a>
<ul>
<li>allow for statically checked compilation configurations</li>
<li>explicit variable capture could be modelled as a coeffect</li>
<li>could subsume quantitative type theory, implicit arguments, etc</li>
<li>not yet integrated into dependent types in the research literature</li>
</ul>
</li>
<li>Row polymorphism
<ul>
<li>no research on integrating these with dependent records and inductive data types</li>
</ul>
</li>
<li>Program composition via category theory
<ul>
<li>Challenging to integrate in the presence of strict evaluation</li>
<li>Similar problems to effect systems: we don't want to allocate intermediate
data structures, instead we want to build up stack allocated state machines
(like in Rust's future and iterator traits) to be executed later</li>
</ul>
</li>
</ul>
<a class="header" href="#a-possible-implementation-plan" id="a-possible-implementation-plan"><h2>A possible implementation plan</h2></a>
<ol>
<li>Start with a simple dependent type system, like <a href="https://www.andres-loeh.de/LambdaPi/">LambdaPi</a></li>
<li>Implement additional language extensions needed for actual usefulness
<ul>
<li>dependent records</li>
<li>let/where bindings</li>
<li>quantitative type theory</li>
<li>implicit arguments</li>
<li>instance arguments</li>
<li>better universe handling (or a flag to turn on <code>Type : Type</code> in the interim)</li>
</ul>
</li>
<li>Implement back end(s)
<ul>
<li>JIT and embeddable runtime (for bootstrapping usage) - possibly with
<a href="https://github.com/nbp/holyjit">HolyJIT</a>?</li>
<li>Optimizing compiler - Possibly with LLVM or <a href="https://github.com/Cretonne/cretonne">Cretonne</a>,
or a verified compiler (like CompCert) in the future
<ul>
<li>Cretonne would unlock WebASM, which would be a huge boost</li>
<li>Figure out how to integrate with libraries written in other languages,
like C or Rust</li>
</ul>
</li>
</ul>
</li>
</ol>
<p>By starting with a JIT we could get initial usage from embedding the language
within existing Rust programs, like games. Looking into the future it would also
be nice to then move forward towards implementing a native compiler, however.</p>
<p>At the moment we are building the language in Rust, but perhaps it would be
better to build a verified implementation in Coq/Agda/Lean/Idris/something else.
That way we can actually start proving some of the claims we desire to make
about our system. A concern could be that we go too far down the route of
implementation and it would be extremely challenging to then form a solid
specification for what we are building. On the other hand, as always, the
downside of a verified implementation is that it could take a prohibitive
amount of time to complete.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../appendix/index.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../appendix/theory.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a href="../appendix/index.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a href="../appendix/theory.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
